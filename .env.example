# =============================================================================
# ComfyUI RunPod Serverless Configuration
# =============================================================================
# Copy this file to .env and configure your settings

# -----------------------------------------------------------------------------
# ComfyUI Configuration
# -----------------------------------------------------------------------------
COMFY_PORT=8188
COMFY_HOST=127.0.0.1
COMFY_REFRESH_MODELS=true

# Startup timeout in seconds (default: 600 = 10 minutes)
# Increase if ComfyUI takes longer to start (e.g., large model downloads)
COMFYUI_STARTUP_TIMEOUT=600

# -----------------------------------------------------------------------------
# Workflow Configuration
# -----------------------------------------------------------------------------
# Automatically randomize seed values in workflows (recommended: true)
RANDOMIZE_SEEDS=true

# Maximum time to wait for workflow completion (seconds)
# Increase for complex video workflows
WORKFLOW_MAX_WAIT_TIME=3600

# Poll interval for checking workflow status (seconds)
WORKFLOW_POLL_INTERVAL=5

# -----------------------------------------------------------------------------
# Storage Configuration - S3 (Recommended for HTTP access)
# -----------------------------------------------------------------------------
# S3-compatible storage (Cloudflare R2, AWS S3, Backblaze B2, etc.)

# Required: S3 bucket name
S3_BUCKET=

# Required: S3 credentials
S3_ACCESS_KEY=
S3_SECRET_KEY=

# S3 endpoint URL (for S3-compatible services)
# Examples:
# - Cloudflare R2: https://<account-id>.r2.cloudflarestorage.com
# - AWS S3: https://s3.amazonaws.com (or region-specific)
# - Backblaze B2: https://s3.us-west-002.backblazeb2.com
S3_ENDPOINT_URL=

# S3 region (default: auto for most S3-compatible services)
S3_REGION=auto

# Optional: Custom public URL prefix (e.g., CDN URL)
# If set, this will be used instead of presigned URLs
S3_PUBLIC_URL=

# S3 signed URL expiry time in seconds (default: 1 hour)
S3_SIGNED_URL_EXPIRY=3600

# Cache control headers for uploaded files (default: 1 year public cache)
S3_CACHE_CONTROL=public, max-age=31536000

# S3 signature version (default: s3v4)
S3_SIGNATURE_VERSION=s3v4

# S3 addressing style (default: path)
S3_ADDRESSING_STYLE=path

# -----------------------------------------------------------------------------
# Network Volume Configuration (Fallback storage)
# -----------------------------------------------------------------------------
# Path to RunPod Network Volume (default: /runpod-volume)
RUNPOD_VOLUME_PATH=/runpod-volume

# Alternative output directory (optional)
RUNPOD_OUTPUT_DIR=

# Timeout for detecting network volume (seconds)
NETWORK_VOLUME_TIMEOUT=15

# -----------------------------------------------------------------------------
# Cleanup Configuration
# -----------------------------------------------------------------------------
# Automatically clean up temporary ComfyUI output files after upload (recommended: true)
CLEANUP_TEMP_FILES=true

# -----------------------------------------------------------------------------
# Container Caching
# -----------------------------------------------------------------------------
# Enable container caching for faster cold starts (RunPod Serverless feature)
ENABLE_CONTAINER_CACHE=true

# -----------------------------------------------------------------------------
# Logging and Debugging
# -----------------------------------------------------------------------------
# Enable debug logging for S3 URLs (WARNING: exposes authentication tokens in logs!)
DEBUG_S3_URLS=false

# Log file path (optional)
LOG_FILE=

# Main log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Library-specific log levels (optional, defaults to WARNING)
LOG_LEVEL_URLLIB3=WARNING
LOG_LEVEL_REQUESTS=WARNING
LOG_LEVEL_BOTO3=WARNING
LOG_LEVEL_BOTOCORE=WARNING

# -----------------------------------------------------------------------------
# Development Configuration
# -----------------------------------------------------------------------------
# Git user information (for maintenance scripts)
GIT_USER_EMAIL=codex@runpod.io
GIT_USER_NAME=Codex User

# Expected repository branch (for updates)
EXPECTED_REPO_BRANCH=main

# Retry configuration for network operations
RETRY_ATTEMPTS=3
RETRY_DELAY=2

# -----------------------------------------------------------------------------
# Performance Tuning
# -----------------------------------------------------------------------------
# PyTorch CUDA memory allocation (adjust based on GPU memory)
PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:1024,expandable_segments:True

# Enable TensorFloat-32 for faster but less precise computations
TORCH_ALLOW_TF32_CUBLAS_OVERRIDE=1

# -----------------------------------------------------------------------------
# Example Configurations
# -----------------------------------------------------------------------------

# Cloudflare R2 Example:
# S3_BUCKET=comfyui-outputs
# S3_ACCESS_KEY=your-r2-access-key
# S3_SECRET_KEY=your-r2-secret-key
# S3_ENDPOINT_URL=https://your-account-id.r2.cloudflarestorage.com
# S3_REGION=auto

# AWS S3 Example:
# S3_BUCKET=your-bucket-name
# S3_ACCESS_KEY=your-aws-access-key
# S3_SECRET_KEY=your-aws-secret-key
# S3_REGION=us-east-1

# Backblaze B2 Example:
# S3_BUCKET=your-bucket-name
# S3_ACCESS_KEY=your-key-id
# S3_SECRET_KEY=your-application-key
# S3_ENDPOINT_URL=https://s3.us-west-002.backblazeb2.com
# S3_REGION=us-west-002